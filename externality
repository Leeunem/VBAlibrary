'###### URLopening 
Option Explicit

Private Declare Function ShellExecute _
  Lib "shell32.dll" Alias "ShellExecuteA" ( _
  ByVal hWnd As Long, _
  ByVal Operation As String, _
  ByVal Filename As String, _
  Optional ByVal Parameters As String, _
  Optional ByVal Directory As String, _
  Optional ByVal WindowStyle As Long = vbMinimizedFocus _
  ) As Long
'--------------------------------------------------------
Public Sub OpenUrl()

    Dim lSuccess As Long
    lSuccess = ShellExecute(0, "Open", "#####HTTP#####")

End Sub
'########## Create a new mail
Sub mail()

'########## VARIABLE LIBRARY ##########
Dim i As Integer

Dim objOutlook As Object
Dim objMail As Object

Dim MasterWB As Workbook
Dim db As Workbook

Dim datasheet As Worksheet

Dim rngTo As Range
Dim rngCC As Range
Dim rngSubject As Range
Dim rngAttach As Range

Dim BodyTemplate As String
Dim body_path As String
Dim db_path As String
Dim db_sheet As String

'########## SET UP ##########
'Master Set Up
Set MasterWB = ActiveWorkbook
Set objOutlook = CreateObject("Outlook.Application")
Set objMail = objOutlook.CreateItem(0)

'Database Set Up
db_path = "###" '..............................................................User Preference
db_sheet = "###" '.............................................................User Preference
Workbooks.Open Filename:=db_path
Set db = ActiveWorkbook
Set datasheet = Sheets(db_sheet)

'Mail Set Up
body_path = "###"

'########## SCRIPT ##########
i = ActiveCell.Row '............................................................User Preference

With ActiveSheet
    Set rngTo = datasheet.Cells(i, 1)
    Set rngCC = datasheet.Cells(i, 2)
    Set rngSubject = datasheet.Cells(i, 3)
    Set rngAttach = datasheet.Cells(i, 5)
End With

'Body from Note template
Body Template = GetFileContent(body_path)

'Body from hardcoded template
'BodyTemplate = "Line 1" & _
                vbCrLf & vbCrLf & _
                "Line 2" & _
                vbCrLf & vbCrLf & _
                "Line 3"

With objMail
    .To = rngTo.Value
    .CC = rngCC.Value
    .Subject = rngSubject.Value
    .Body = BodyTemplate
    .Attachments.Add rngAttach.Value
    .Display '/.Send /.Save (to drafts)
End With

Set objOutlook = Nothing
Set objMail = Nothing
Set rngTo = Nothing
Set rngSubject = Nothing
Set rngBody = Nothing
Set rngAttach = Nothing

End Sub

'########## FUNCTIONS ##########

Function GetFileContent(Name As String) As String
    Dim intUnit As Integer
    
    On Error GoTo ErrGetFileContent
    intUnit = FreeFile
    Open Name For Input As intUnit
    GetFileContent = Input(LOF(intUnit), intUnit)
ErrGetFileContent:
    Close intUnit
    Exit Function
End Function


'########## Create a notepad
Option Explicit
Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
'Finds a window with the name, returns the handle.
Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Integer, ByVal lParam As Any) As Long
'Sends a specified message to the window handle that you give it.
Private Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'Gets a controls window handle. The form window handle must be specified to get a decent control.
Const WM_SETTEXT As Long = &HC
'Sets the text of this control.

Sub Write2Notepad()
Dim hWnd As Long
Dim chWnd As Long
Dim s As String

s = "The value of i is " & 999.99 & vbCrLf




'start Notepad
Call Shell("NOTEPAD.EXE", vbNormalFocus)
hWnd = FindWindow("Notepad", vbNullString)

'Find a control window handle... in Notepad, there's the main Textbox that you want.
chWnd = FindWindowEx(hWnd, ByVal 0&, vbNullString, vbNullString)
SendMessage chWnd, WM_SETTEXT, ByVal 0&, s
End Sub
